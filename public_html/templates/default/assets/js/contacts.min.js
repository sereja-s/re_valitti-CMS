import"./main.min.js";import{b as h,c as b,e as m,f as g}from"./common.min.js";class v{constructor(t){let s={logging:!0,init:!0,attributeOpenButton:"data-fls-popup-link",attributeCloseButton:"data-fls-popup-close",fixElementSelector:"[data-fls-lp]",attributeMain:"data-fls-popup",youtubeAttribute:"data-fls-popup-youtube",youtubePlaceAttribute:"data-fls-popup-youtube-place",setAutoplayYoutube:!0,classes:{popup:"popup",popupContent:"data-fls-popup-body",popupActive:"data-fls-popup-active",bodyActive:"data-fls-popup-open"},focusCatch:!0,closeEsc:!0,bodyLock:!0,hashSettings:{location:!0,goHash:!0},on:{beforeOpen:function(){},afterOpen:function(){},beforeClose:function(){},afterClose:function(){}}};this.youTubeCode,this.isOpen=!1,this.targetOpen={selector:!1,element:!1},this.previousOpen={selector:!1,element:!1},this.lastClosed={selector:!1,element:!1},this._dataValue=!1,this.hash=!1,this._reopen=!1,this._selectorOpen=!1,this.lastFocusEl=!1,this._focusEl=["a[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"button:not([disabled]):not([aria-hidden])","select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","area[href]","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],this.options={...s,...t,classes:{...s.classes,...t?.classes},hashSettings:{...s.hashSettings,...t?.hashSettings},on:{...s.on,...t?.on}},this.bodyLock=!1,this.options.init&&this.initPopups()}initPopups(){this.buildPopup(),this.eventsPopup()}buildPopup(){}eventsPopup(){document.addEventListener("click",(function(t){const s=t.target.closest(`[${this.options.attributeOpenButton}]`);if(s){if(t.preventDefault(),this._dataValue=s.getAttribute(this.options.attributeOpenButton)?s.getAttribute(this.options.attributeOpenButton):"error",this.youTubeCode=s.getAttribute(this.options.youtubeAttribute)?s.getAttribute(this.options.youtubeAttribute):null,this._dataValue!=="error"){this.isOpen||(this.lastFocusEl=s),this.targetOpen.selector=`${this._dataValue}`,this._selectorOpen=!0,this.open();return}return}if(t.target.closest(`[${this.options.attributeCloseButton}]`)||!t.target.closest(`[${this.options.classes.popupContent}]`)&&this.isOpen){t.preventDefault(),this.close();return}}).bind(this)),document.addEventListener("keydown",(function(t){if(this.options.closeEsc&&t.which==27&&t.code==="Escape"&&this.isOpen){t.preventDefault(),this.close();return}if(this.options.focusCatch&&t.which==9&&this.isOpen){this._focusCatch(t);return}}).bind(this)),this.options.hashSettings.goHash&&(window.addEventListener("hashchange",(function(){window.location.hash?this._openToHash():this.close(this.targetOpen.selector)}).bind(this)),window.location.hash&&this._openToHash())}open(t){if(h&&(this.bodyLock=!!(document.documentElement.hasAttribute("data-fls-scrolllock")&&!this.isOpen),t&&typeof t=="string"&&t.trim()!==""&&(this.targetOpen.selector=t,this._selectorOpen=!0),this.isOpen&&(this._reopen=!0,this.close()),this._selectorOpen||(this.targetOpen.selector=this.lastClosed.selector),this._reopen||(this.previousActiveElement=document.activeElement),this.targetOpen.element=document.querySelector(`[${this.options.attributeMain}=${this.targetOpen.selector}]`),this.targetOpen.element)){const s=this.youTubeCode||this.targetOpen.element.getAttribute(`${this.options.youtubeAttribute}`);if(s){const o=`https://www.youtube.com/embed/${s}?rel=0&showinfo=0&autoplay=1`,n=document.createElement("iframe"),i=this.options.setAutoplayYoutube?"autoplay;":"";n.setAttribute("allowfullscreen",""),n.setAttribute("allow",`${i}; encrypted-media`),n.setAttribute("src",o),this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`)||this.targetOpen.element.querySelector("[data-fls-popup-content]").setAttribute(`${this.options.youtubePlaceAttribute}`,""),this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`).appendChild(n)}this.options.hashSettings.location&&(this._getHash(),this._setHash()),this.options.on.beforeOpen(this),document.dispatchEvent(new CustomEvent("beforePopupOpen",{detail:{popup:this}})),this.targetOpen.element.setAttribute(this.options.classes.popupActive,""),document.documentElement.setAttribute(this.options.classes.bodyActive,""),this._reopen?this._reopen=!1:this.bodyLock||b(),this.targetOpen.element.setAttribute("aria-hidden","false"),this.previousOpen.selector=this.targetOpen.selector,this.previousOpen.element=this.targetOpen.element,this._selectorOpen=!1,this.isOpen=!0,setTimeout(()=>{this._focusTrap()},50),this.options.on.afterOpen(this),document.dispatchEvent(new CustomEvent("afterPopupOpen",{detail:{popup:this}}))}}close(t){t&&typeof t=="string"&&t.trim()!==""&&(this.previousOpen.selector=t),!(!this.isOpen||!h)&&(this.options.on.beforeClose(this),document.dispatchEvent(new CustomEvent("beforePopupClose",{detail:{popup:this}})),this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`)&&setTimeout(()=>{this.targetOpen.element.querySelector(`[${this.options.youtubePlaceAttribute}]`).innerHTML=""},500),this.previousOpen.element.removeAttribute(this.options.classes.popupActive),this.previousOpen.element.setAttribute("aria-hidden","true"),this._reopen||(document.documentElement.removeAttribute(this.options.classes.bodyActive),this.bodyLock||m(),this.isOpen=!1),this._removeHash(),this._selectorOpen&&(this.lastClosed.selector=this.previousOpen.selector,this.lastClosed.element=this.previousOpen.element),this.options.on.afterClose(this),document.dispatchEvent(new CustomEvent("afterPopupClose",{detail:{popup:this}})),setTimeout(()=>{this._focusTrap()},50))}_getHash(){this.options.hashSettings.location&&(this.hash=`#${this.targetOpen.selector}`)}_openToHash(){let t=window.location.hash.replace("#","");const s=document.querySelector(`[${this.options.attributeOpenButton}="${t}"]`);s&&(this.youTubeCode=s.getAttribute(this.options.youtubeAttribute)?s.getAttribute(this.options.youtubeAttribute):null),t&&this.open(t)}_setHash(){history.pushState("","",this.hash)}_removeHash(){history.pushState("","",window.location.href.split("#")[0])}_focusCatch(t){const s=this.targetOpen.element.querySelectorAll(this._focusEl),o=Array.prototype.slice.call(s),n=o.indexOf(document.activeElement);t.shiftKey&&n===0&&(o[o.length-1].focus(),t.preventDefault()),!t.shiftKey&&n===o.length-1&&(o[0].focus(),t.preventDefault())}_focusTrap(){const t=this.previousOpen.element.querySelectorAll(this._focusEl);!this.isOpen&&this.lastFocusEl?this.lastFocusEl.focus():t[0].focus()}}document.querySelector("[data-fls-popup]")&&window.addEventListener("load",()=>window.flsPopup=new v({}));const E=()=>{const e=document.querySelectorAll("textarea[data-fls-input-autoheight]");if(e.length){let t=function(s,o){s.style.height=`${o}px`};e.forEach(s=>{const o=s.hasAttribute("data-fls-input-autoheight-min")?Number(s.dataset.flsInputAutoheightMin):Number(s.offsetHeight),n=s.hasAttribute("data-fls-input-autoheight-max")?Number(s.dataset.flsInputAutoheightMax):1/0;t(s,Math.min(o,n)),s.addEventListener("input",()=>{s.scrollHeight>o&&(s.style.height="auto",t(s,Math.min(Math.max(s.scrollHeight,o),n)))})})}};document.querySelector("textarea[data-fls-input-autoheight]")&&window.addEventListener("load",E);let l={getErrors(e){let t=0,s=e.querySelectorAll("[required]");return s.length&&s.forEach(o=>{(o.offsetParent!==null||o.tagName==="SELECT")&&!o.disabled&&(t+=this.validateInput(o))}),t},validateInput(e){let t=0;return e.type==="email"?(e.value=e.value.replace(" ",""),this.emailTest(e)?(this.addError(e),this.removeSuccess(e),t++):(this.removeError(e),this.addSuccess(e))):e.type==="checkbox"&&!e.checked?(this.addError(e),this.removeSuccess(e),t++):e.value.trim()?(this.removeError(e),this.addSuccess(e)):(this.addError(e),this.removeSuccess(e),t++),t},addError(e){e.classList.add("--form-error"),e.parentElement.classList.add("--form-error");let t=e.parentElement.querySelector("[data-fls-form-error]");t&&e.parentElement.removeChild(t),e.dataset.flsFormErrtext&&e.parentElement.insertAdjacentHTML("beforeend",`<div data-fls-form-error>${e.dataset.flsFormErrtext}</div>`)},removeError(e){e.classList.remove("--form-error"),e.parentElement.classList.remove("--form-error"),e.parentElement.querySelector("[data-fls-form-error]")&&e.parentElement.removeChild(e.parentElement.querySelector("[data-fls-form-error]"))},addSuccess(e){e.classList.add("--form-success"),e.parentElement.classList.add("--form-success")},removeSuccess(e){e.classList.remove("--form-success"),e.parentElement.classList.remove("--form-success")},formClean(e){e.reset(),setTimeout(()=>{let t=e.querySelectorAll("input,textarea");for(let o=0;o<t.length;o++){const n=t[o];n.parentElement.classList.remove("--form-focus"),n.classList.remove("--form-focus"),l.removeError(n)}let s=e.querySelectorAll('input[type="checkbox"]');if(s.length&&s.forEach(o=>{o.checked=!1}),window.flsSelect){let o=e.querySelectorAll("select[data-fls-select]");o.length&&o.forEach(n=>{window.flsSelect.selectBuild(n)})}},0)},emailTest(e){return!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(e.value)}};function y(){function e(){const s=document.forms;if(s.length)for(const i of s)i.hasAttribute("data-fls-form-novalidate")||i.setAttribute("novalidate",!0),i.addEventListener("submit",function(a){const r=a.target;o(r,a)}),i.addEventListener("reset",function(a){const r=a.target;l.formClean(r)});async function o(i,a){if(l.getErrors(i)===0)if(i.dataset.flsForm==="ajax"){a.preventDefault();const u=i.getAttribute("action")?i.getAttribute("action").trim():"#",p=i.getAttribute("method")?i.getAttribute("method").trim():"GET",d=new FormData(i);i.classList.add("--sending");const c=await fetch(u,{method:p,body:d});if(c.ok){let f=await c.json();i.classList.remove("--sending"),n(i,f)}else i.classList.remove("--sending")}else i.dataset.flsForm==="dev"&&(a.preventDefault(),n(i));else if(a.preventDefault(),i.querySelector(".--form-error")&&i.hasAttribute("data-fls-form-gotoerr")){const u=i.dataset.flsFormGotoerr?i.dataset.flsFormGotoerr:".--form-error";g(u)}}function n(i,a=""){document.dispatchEvent(new CustomEvent("formSent",{detail:{form:i}})),setTimeout(()=>{if(window.flsPopup){const r=i.dataset.flsFormPopup;r&&window.flsPopup.open(r)}},0),l.formClean(i)}}function t(){document.body.addEventListener("focusin",function(s){const o=s.target;(o.tagName==="INPUT"||o.tagName==="TEXTAREA")&&(o.hasAttribute("data-fls-form-nofocus")||(o.classList.add("--form-focus"),o.parentElement.classList.add("--form-focus")),o.hasAttribute("data-fls-form-validatenow")&&l.removeError(o))}),document.body.addEventListener("focusout",function(s){const o=s.target;(o.tagName==="INPUT"||o.tagName==="TEXTAREA")&&(o.hasAttribute("data-fls-form-nofocus")||(o.classList.remove("--form-focus"),o.parentElement.classList.remove("--form-focus")),o.hasAttribute("data-fls-form-validatenow")&&l.validateInput(o))})}e(),t()}document.querySelector("[data-fls-form]")&&window.addEventListener("load",y);
